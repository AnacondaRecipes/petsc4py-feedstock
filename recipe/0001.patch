From f0a1a536b72b14d45f7f3606b1e792fb203684a4 Mon Sep 17 00:00:00 2001
From: Lisandro Dalcin <dalcinl@gmail.com>
Date: Wed, 22 Nov 2017 19:11:45 +0300
Subject: [PATCH 1/2] Rework filtering of Cython warning about NumPy size
 changes

---
 src/PETSc.py        | 3 ---
 src/lib/__init__.py | 5 ++++-
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/src/PETSc.py b/src/PETSc.py
index 69fcb3c..e9ad1b4 100644
--- a/src/PETSc.py
+++ b/src/PETSc.py
@@ -1,6 +1,3 @@
-import warnings
-warnings.filterwarnings("ignore", message="numpy.dtype size changed")
-warnings.filterwarnings("ignore", message="numpy.ndarray size changed")
 ARCH = None
 from petsc4py.lib import ImportPETSc
 PETSc = ImportPETSc(ARCH)
diff --git a/src/lib/__init__.py b/src/lib/__init__.py
index 7e02763..e206b00 100644
--- a/src/lib/__init__.py
+++ b/src/lib/__init__.py
@@ -44,7 +44,7 @@ def Import(pkg, name, path, arch):
     """
     Import helper for PETSc-based extension modules.
     """
-    import sys, os, imp
+    import sys, os, imp, warnings
     # full dotted module name
     fullname = '%s.%s' % (pkg, name)
     # test if extension module was already imported
@@ -58,6 +58,9 @@ def Import(pkg, name, path, arch):
         if arch is not None and arch != module.__arch__:
             raise ImportError("%s already imported" % module)
         return module
+    # silence annoying Cython warning
+    warnings.filterwarnings("ignore", message="numpy.dtype size changed")
+    warnings.filterwarnings("ignore", message="numpy.ndarray size changed")
     # import extension module from 'path/arch' directory
     pathlist = [os.path.join(path, arch)]
     f, fn, info = imp.find_module(name, pathlist)
-- 
2.14.3

